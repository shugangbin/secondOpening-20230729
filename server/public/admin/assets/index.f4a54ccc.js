import{W as U,X as V,J as _}from"./element-plus.6ae56789.js";import{a as D,g as p,R as y,f as m}from"./index.9ffd2ade.js";import{d as L,s as P,r as f,e as C,t as R,o as c,c as g,V as b,M as k,I as N,L as j,a as v,W as I,aa as W,U as q,S as J}from"./@vue.581f5ce0.js";import{_ as M}from"./vue-drag-resize.3665149e.js";const O=L({components:{},props:{type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},showProgress:{type:Boolean,default:!1}},emits:["change","error","success"],setup(e,{emit:a}){const h=D(),n=P(),E=f(`${p.baseUrl}${p.urlPrefix}/upload/${e.type}`),F=C(()=>({token:h.token,version:p.version})),o=f(!1),u=f([]),d=(s,l,r)=>{o.value=!0,u.value=R(r)},t=(s,l,r)=>{var S;r.every(B=>B.status=="success")&&((S=n.value)==null||S.clearFiles(),o.value=!1),a("change",l),s.code==y.SUCCESS&&a("success",s),s.code==y.FAIL&&s.msg&&m.msgError(s.msg)},i=(s,l)=>{var r;m.msgError(`${l.name}\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25`),(r=n.value)==null||r.abort(l),o.value=!1,a("change",l),a("error",l)},A=()=>{m.msgError(`\u8D85\u51FA\u4E0A\u4F20\u4E0A\u9650${e.limit}\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20`)},$=()=>{var s;(s=n.value)==null||s.clearFiles(),o.value=!1},w=C(()=>{switch(e.type){case"image":return".jpg,.png,.gif,.jpeg";case"video":return".wmv,.avi,.mpg,.mpeg,.3gp,.mov,.mp4,.flv,.rmvb,.mkv";default:return"*"}});return{uploadRefs:n,action:E,headers:F,visible:o,fileList:u,getAccept:w,handleProgress:d,handleSuccess:t,handleError:i,handleExceed:A,handleClose:$}}}),X={class:"upload"},z={class:"file-list p-4"},G={class:"flex-1"};function H(e,a,h,n,E,F){const o=U,u=V,d=_;return c(),g("div",X,[b(o,{ref:"uploadRefs",action:e.action,multiple:e.multiple,limit:e.limit,"show-file-list":!1,headers:e.headers,data:e.data,"on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError,accept:e.getAccept},{default:k(()=>[N(e.$slots,"default")]),_:3},8,["action","multiple","limit","headers","data","on-progress","on-success","on-exceed","on-error","accept"]),e.showProgress&&e.fileList.length?(c(),j(d,{key:0,modelValue:e.visible,"onUpdate:modelValue":a[0]||(a[0]=t=>e.visible=t),title:"\u4E0A\u4F20\u8FDB\u5EA6","close-on-click-modal":!1,width:"500px",modal:!1,onClose:e.handleClose},{default:k(()=>[v("div",z,[(c(!0),g(I,null,W(e.fileList,(t,i)=>(c(),g("div",{key:i,class:"mb-5"},[v("div",null,q(t.name),1),v("div",G,[b(u,{percentage:parseInt(t.percentage)},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue","onClose"])):J("",!0)])}const x=M(O,[["render",H]]);export{x as U};
