import{_ as t}from"./page-meta.e1766212.js";import{_ as e,aB as s,aC as a,o as i,e as l,f as o,g as n,y as h,s as d,T as c,i as r,F as u,l as p,h as m,t as f,j as x,k as b,aD as g,aE as v,d as y,B as _,W as w,r as k,a as C,b as W,n as B,u as X,K as F}from"./index-5fd89c82.js";import{_ as $}from"./z-paging.3f3ad392.js";import{q as S,h as E}from"./chat.b5adffe9.js";import{u as T}from"./useCopy.dbed25b8.js";const A=e({name:"u-swipe-action",emits:["click","content-click","open","close"],props:{index:{type:[Number,String],default:""},btnWidth:{type:[String,Number],default:180},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},bgColor:{type:String,default:"#ffffff"},vibrateShort:{type:Boolean,default:!1},options:{type:Array,default:()=>[]}},watch:{show:{immediate:!0,handler(t,e){t?this.open():this.close()}}},data(){return{moveX:0,scrollX:0,status:!1,movableAreaWidth:0,elId:this.$u.guid(),showBtn:!1}},computed:{movableViewWidth(){return this.movableAreaWidth+this.allBtnWidth+"px"},innerBtnWidth(){return s(this.btnWidth)},allBtnWidth(){return s(this.btnWidth)*this.options.length},btnStyle(){return t=>(t.width=this.btnWidth+"rpx",t)}},mounted(){this.getActionRect()},methods:{btnClick(t){this.status=!1,this.$emit("click",this.index,t)},change(t){this.scrollX=t.detail.x},close(){this.moveX=0,this.status=!1},open(){this.disabled||(this.moveX=-this.allBtnWidth,this.status=!0)},touchend(){this.moveX=this.scrollX,this.$nextTick((function(){0==this.status?this.scrollX<=-this.allBtnWidth/4?(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent(),this.vibrateShort&&a()):(this.moveX=0,this.status=!1,this.emitCloseEvent()):this.scrollX>3*-this.allBtnWidth/4?(this.moveX=0,this.$nextTick((()=>{this.moveX=101})),this.status=!1,this.emitCloseEvent()):(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent())}))},emitOpenEvent(){this.$emit("open",this.index)},emitCloseEvent(){this.$emit("close",this.index)},touchstart(){},getActionRect(){this.$uGetRect(".u-swipe-action").then((t=>{this.movableAreaWidth=t.width,this.$nextTick((()=>{this.showBtn=!0}))}))},contentClick(){1==this.status&&(this.status="close",this.moveX=0),this.$emit("content-click",this.index)}}},[["render",function(t,e,s,a,y,_){const w=b,k=g,C=v;return i(),l(w,{class:""},{default:o((()=>[n(C,{class:"u-swipe-action",style:h({backgroundColor:s.bgColor})},{default:o((()=>[n(k,{class:"u-swipe-view",onChange:_.change,onTouchend:_.touchend,onTouchstart:_.touchstart,direction:"horizontal",disabled:s.disabled,x:y.moveX,style:h({width:_.movableViewWidth?_.movableViewWidth:"100%"})},{default:o((()=>[n(w,{class:"u-swipe-content",onClick:d(_.contentClick,["stop"])},{default:o((()=>[c(t.$slots,"default",{},void 0,!0)])),_:3},8,["onClick"]),y.showBtn?(i(!0),r(u,{key:0},p(s.options,((t,e)=>(i(),l(w,{class:"u-swipe-del",onClick:d((t=>_.btnClick(e)),["stop"]),style:h([_.btnStyle(t.style)]),key:e},{default:o((()=>[n(w,{class:"u-btn-text"},{default:o((()=>[m(f(t.text),1)])),_:2},1024)])),_:2},1032,["onClick","style"])))),128)):x("v-if",!0)])),_:3},8,["onChange","onTouchend","onTouchstart","disabled","x","style"])])),_:3},8,["style"])])),_:3})}],["__scopeId","data-v-d29e9c37"]]),j=y({__name:"collection",setup(e){const s=_(),a=w([{text:"取消收藏",style:{color:"#FFFFFF",backgroundColor:"#FF2C3C"}}]),{copy:h}=T(),d=k([]),c=async(t,e)=>{const{lists:a}=await S({page_no:t,page_size:e});a.forEach((t=>{t.show=!1})),d.value=a,s.value.complete(a)},x=async(t,e)=>{if(0==e){const e=d.value[t].id;try{await E({collect_id:e}),s.value.reload()}catch(a){console.log("取消收藏报错=>",a)}}};return(e,g)=>{const v=C(W("page-meta"),t),y=b,_=F,w=C(W("u-swipe-action"),A),k=C(W("z-paging"),$);return i(),r(u,null,[n(v,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),n(k,{ref_key:"paging",ref:s,modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=t=>d.value=t),onQuery:c,fixed:!1,"use-page-scroll":""},{default:o((()=>[(i(!0),r(u,null,p(d.value,((t,e)=>(i(),l(y,{class:"m-[30rpx] bg-white",key:t.id},{default:o((()=>[n(w,{show:t.show,index:e,onClick:x,options:a,"btn-width":"130"},{default:o((()=>[n(y,{class:"p-[30rpx]"},{default:o((()=>[n(y,{class:"flex"},{default:o((()=>[n(y,{class:"w-[40rpx] h-[40rpx] bg-[#4073FA] text-white text-center leading-[40rpx] flex-shrink-0"},{default:o((()=>[m(" 问 ")])),_:1}),n(_,{class:"ml-[20rpx]"},{default:o((()=>[m(f(t.chat_records.ask),1)])),_:2},1024)])),_:2},1024),n(y,{class:"flex mt-[30rpx]"},{default:o((()=>[n(y,{class:"w-[40rpx] h-[40rpx] bg-[#FBBC2D] text-center leading-[40rpx] flex-shrink-0"},{default:o((()=>[m(" 答 ")])),_:1}),n(y,{class:"flex-1 ml-[20rpx]"},{default:o((()=>[(i(!0),r(u,null,p(t.chat_records.reply,((t,e)=>(i(),l(y,{key:e,class:B(["mb-[20rpx]",{" pt-[20rpx] border-t border-solid border-light border-0":e>0}])},{default:o((()=>[n(_,null,{default:o((()=>[m(f(t),1)])),_:2},1024),n(y,{class:"flex mt-[10rpx]"},{default:o((()=>[n(y,{class:"text-sm text-muted",onClick:e=>X(h)(t)},{default:o((()=>[m(" 复制 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["show","index","options"])])),_:2},1024)))),128))])),_:1},8,["modelValue"])],64)}}});export{j as default};
