import{_ as G}from"./index.vue.41260c16.js";import{_ as H}from"./client-only.50432bec.js";import{_ as Q}from"./index.vue.758401c0.js";import{a as z,r as s,o as d,i as m,h as i,t as A,k as M,u as o,f as c,e as _,aq as W,z as X,l as Y,T as Z,ab as ee,a7 as te,a9 as ae,ak as oe,K as ne,aw as se,a2 as le,F as V,j as R,ae as re,ad as U,a0 as q,c as ce}from"./entry.47644ad8.js";import{_ as O}from"./_plugin-vue_export-helper.c27b6911.js";import{E as ie}from"./index.5f1ada03.js";import{_ as ue}from"./chatting.593544d3.js";import{_ as pe}from"./layout.6eb0f29a.js";/* empty css                     */import{g as de,b as _e,c as me}from"./model-picker.vue.156c1490.js";import{E as fe}from"./index.7ded7c66.js";import{w as ve}from"./index.1d02bbbe.js";import"./index.fd4342e5.js";/* empty css                */import"./index.2d38d06b.js";import"./my.94b48df2.js";import"./_commonjsHelpers.042e6b4d.js";import"./index.d4d0012e.js";import"./dropdown.515293b4.js";import"./refs.1a6521b3.js";/* empty css                    *//* empty css                  */import"./throttle.a2b1ebd6.js";import"./debounce.ad6365f0.js";import"./position.0a5dfbe0.js";const he={class:"cursor-default"},ge=z({__name:"index",props:{title:{type:String,default:""},length:{type:Number,default:0}},setup(f){const u=s(!0),B=()=>{u.value==!0?u.value=!1:u.value=!0};return(w,l)=>{const b=Q;return d(),m("div",null,[i("div",{class:"flex items-center justify-between mt-[15px] text-info",onClick:B},[i("div",he,A(f.title),1),i("div",{class:M(["transition-transform rotate-",{"rotate-180":!o(u)}])},[c(b,{name:"el-icon-ArrowUp"})],2)]),c(Z,null,{default:_(()=>[o(u)?(d(),m("div",{key:0,style:W({"max-height":f.length*110+"px"}),class:"dropDownList overflow-hidden"},[X(w.$slots,"menu",{},void 0,!0)],4)):Y("",!0)]),_:3})])}}});const xe=O(ge,[["__scopeId","data-v-2b7032c7"]]);function ye(f){return $request.get({url:"/skill/lists",params:f})}const we={class:"p-[16px]"},be=["onClick"],ke={class:"ml-2 flex-1"},Ce={class:"font-bold"},Se={class:"h-full"},Ie=z({__name:"index",setup(f){const u=ee(),B=te(),w=ae(),l=s(0),b=s(""),k=s(""),E=s([]),F=({id:t,title:n,image:r})=>{e.value=[],l.value=t,b.value=n,k.value=r,q(async()=>{await $(),C.value.scrollToBottom()})},e=s([]),C=s(null),v=s(),N=async()=>{E.value=await ye({keyword:v.value})},$=async()=>{let t=await de({type:3,other_id:l.value,page_type:0});t=t==null?void 0:t.lists.map(n=>n.type==1?{...n,from_avatar:w.userInfo.avatar}:{...n,from_avatar:k.value}),e.value=t},h=s(!1),P=async(t,n)=>{try{h.value=!0,e.value.push({type:1,content:t,from_avatar:w.userInfo.avatar}),e.value.push({type:2,loading:!0,content:[],from_avatar:k.value,id:""}),await _e({model:n,question:t,type:3,other_id:l.value},{onstart(r){S=r},onmessage(r){r.trim().split("data:").forEach(async I=>{if(I!=="")try{const T=JSON.parse(I),{id:L,event:g,data:x,code:p,index:y}=T;g=="error"&&p===101&&B.getIsShowVip?(await re.confirm("开通会员，享受更多权益，VIP期间会员免费通道对话不消耗条数","对话余额不足",{confirmButtonText:"前往开通",cancelButtonText:"取消",type:"warning"}),u.push("/openvip")):g=="error"&&U.msgError(x);let a=e.value.findIndex(D=>D.id===L);if(a===-1&&(a=e.value.length-1,e.value[a].id=L),x&&(e.value[a].content[y]||(e.value[a].content[y]=""),e.value[a].content[y]+=x),g==="finish"){e.value[a].loading=!1;return}}catch{}})},onclose(){h.value=!1,setTimeout($,400)}}),C.value.cleanInput()}catch{h.value=!1,e.value.splice(e.value.length-2,2)}q(()=>{C.value.scrollToBottom()})};let S=null;const j=t=>{S==null||S.cancel(),t&&(e.value[t].loading=!1),h.value=!1},J=async()=>{await U.confirm("确定清空对话？"),await me({type:3,other_id:l.value}),e.value=[]},K=()=>{F(E.value[0].skill[0])};return oe(async()=>{await N(),K()}),ve(v,t=>{N()},{debounce:500}),(t,n)=>{const r=G,I=H,T=xe,L=ie,g=ue,x=pe;return d(),m("div",null,[c(x,{name:"default"},{panel:_(()=>[c(L,{class:"w-[240px] bg-white"},{default:_(()=>[i("div",we,[ne(i("input",{class:"bg-[#f8f8f8] w-full leading-[32px] rounded-[3px] outline-none px-[10px]","onUpdate:modelValue":n[0]||(n[0]=p=>le(v)?v.value=p:null),placeholder:"请输入关键词搜索"},null,512),[[se,o(v)]]),(d(!0),m(V,null,R(o(E),(p,y)=>(d(),ce(T,{title:p.name,length:p.skill.length,key:y},{menu:_(()=>[(d(!0),m(V,null,R(p.skill,(a,D)=>(d(),m("div",{class:M(["bg-[#F8F8F8] flex items-center p-[10px] mt-2 cursor-pointer",{actived:o(l)==a.id,unactived:o(l)!=a.id}]),key:D,onClick:Te=>F(a)},[c(o(fe),{src:a.image,class:"w-[34px] h-[34px] rounded-[8px]"},null,8,["src"]),i("div",ke,[i("div",Ce,A(a.name),1),c(I,null,{default:_(()=>[c(r,{teleported:"",class:"text-tx-secondary",content:a.describe,line:2},null,8,["content"])]),_:2},1024)])],10,be))),128))]),_:2},1032,["title","length"]))),128))])]),_:1})]),default:_(()=>[i("div",Se,[c(g,{class:"h-full",ref_key:"chattingRef",ref:C,title:o(b),selectval:o(l),avatar:o(k),"chat-type":3,"send-disabled":o(h),"content-list":o(e),onClose:j,onUpdate:$,onContentPost:P,onCleanChatLog:J},null,8,["title","selectval","avatar","send-disabled","content-list"])])]),_:1})])}}});const Ze=O(Ie,[["__scopeId","data-v-7ee1e7ba"]]);export{Ze as default};
