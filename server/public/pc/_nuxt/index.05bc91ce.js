import{E as ce}from"./index.2d38d06b.js";import{E as ne,_ as le,a as ie}from"./notice.5978684c.js";import{_ as re}from"./index.1d37229e.js";import{E as _e}from"./index.5f1ada03.js";import{_ as de}from"./index.vue.758401c0.js";import{a as pe,r,ac as ue,b as me,ak as xe,aj as fe,o as s,i as a,f as n,e as f,u as c,c as W,h as e,F as P,j as E,K as Q,l as k,t as d,at as ye,a0 as ve,ad as V,J as he,af as ge,k as T,L as ke,ag as be,ah as we,aK as Ce}from"./entry.47644ad8.js";import{_ as Se}from"./layout.6eb0f29a.js";/* empty css                  *//* empty css                     *//* empty css                */import{g as Pe,a as Ee}from"./my.94b48df2.js";import{Q as Ie,m as Le,g as Be,p as ze,O as Fe}from"./pay.9680cc12.js";import{u as We}from"./usePolling.9af4c0ec.js";import{_ as Ve}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.d4237e01.js";import"./throttle.a2b1ebd6.js";import"./debounce.ad6365f0.js";const _=b=>(be("data-v-3282f1eb"),b=b(),we(),b),je={key:0,class:"w-full h-full bg-white rounded-[6px] flex items-center justify-center"},De=_(()=>e("div",{class:"text-xl"},"开通会员功能未开启!",-1)),Me=[De],Ne={class:"p-[16px]"},$e=_(()=>e("div",{class:"text-[18px]"},[e("span",{class:"font-medium"},"开通会员"),e("span",{class:"text-[14px] text-[#888] ml-6"}," 会员服务为虚拟产品，支付成功后不支持退款 ")],-1)),Re={class:"bg-[#FCF5E8] flex items-center pl-[10px] mt-[25px] mb-[25px]"},Ae=_(()=>e("img",{src:le,alt:"公告",class:"w-[20px] h-[20px] mr-[10px]"},null,-1)),Ke={class:"w-full flex items-center"},Oe={class:"ml-[10px] leading-[40px]"},Qe={class:"py-[10px] flex"},Te=["onClick"],Ue={class:"bg-[red] inline-block text-white px-[5px] py-[2px] text-[12px] rounded-tl-lg rounded-br-lg"},Je={key:0},qe={key:1},Ge={class:"flex flex-col items-center rounded-lg mb-[30px] mt-[20px] mx-[20px]"},He={class:"text-black flex items-center"},Xe=_(()=>e("span",{class:"text-[18px]"},"¥",-1)),Ye=_(()=>e("span",{class:"mx-[2px] text-[18px]"}," / ",-1)),Ze={class:"text-[18px] truncate max-w-[92px]"},et={key:0,class:"text-sm text-[#999]"},tt={class:"my-[10px] flex items-center member_benefit"},st=_(()=>e("div",{class:"text-black"},"会员权益:",-1)),at={key:0,class:"text-[#23B571] mt-[5px]"},ot={key:1,class:"text-error mt-[5px]"},ct={key:0,class:"flex mt-[20px]"},nt=_(()=>e("div",{class:"text-lg text-black"},"支付方式:",-1)),lt={class:"ml-[20px] flex"},it={class:""},rt=["onClick"],_t=["src"],dt={class:"ml-[5px]"},pt={key:0,class:"flex items-center ml-auto"},ut={key:0,class:"flex ml-[40px]"},mt={class:"pay_way_actived rounded-[8px] p-[10px] w-[140px] h-[140px]"},xt={class:"flex flex-col justify-center ml-[20px]"},ft={class:"text-[#666]"},yt={class:"mt-[10px]"},vt=_(()=>e("span",null,"实付金额",-1)),ht=_(()=>e("div",{class:"mt-[6px]"},"点击重试",-1)),gt=pe({__name:"index",setup(b){const U=r(0),w=r(0),p=ue({statsu:-1,lists:[]}),j=r([]),y=r([]),u=r(0),v=r({from:"member",pay_way:""}),I=r(),C=r(!1),m=r(!1),D=me(()=>p.lists.find(t=>t.id==w.value)),J=async()=>{try{const{status:t,lists:i}=await Pe();p.status=t,p.lists=i;const x=i.find(g=>g.is_default==1),h=i.findIndex(g=>g.is_default==1);x==null?(L(i[0],0),p.lists[0].is_default=1):L(x,h)}catch(t){console.log("获取会员套餐列表错误=>",t)}},q=async()=>{try{const t=await Ee();j.value=t}catch(t){console.log("获取会员套餐人数列表错误=>",t)}},L=async(t,i)=>{m.value||(C.value=!1,w.value=t.id,U.value=i,await ve(),B())},B=async()=>{m.value=!0,S();const t=await Le({member_package_id:w.value});v.value=t,G(t.order_id)},G=async t=>{const{lists:i}=await Be({order_id:t,from:"member"});y.value=i;const x=y.value.find(h=>h.is_default==1);x==null?u.value=y.value[0].pay_way:u.value=x.pay_way,M()},H=t=>{m.value||(S(),m.value=!0,u.value=t,v.value.pay_way=t,M())},X=Ce(),M=async()=>{try{const t=await ze({order_id:v.value.order_id,pay_way:u.value,...v.value,redirect:`${X.public.baseUrl}openvip`});I.value=t,ee(),m.value=!1}catch(t){m.value=!1,console.log("预支付错误=>",t),V.msgError("支付错误，请检查配置或原因")}},Y=async()=>{const{pay_status:t}=await Fe({order_id:v.value.order_id,from:"member"});t==1&&(V.alertSuccess("支付成功"),S(),B())},Z=async()=>{await V.alertWarning("支付超时！"),C.value=!0},{start:ee,end:S,result:kt}=We(Y,{totalTime:300*1e3,callback:Z}),te=()=>{C.value=!1,B()};return xe(()=>{J(),q()}),fe(()=>{S()}),(t,i)=>{const x=ce,h=ie,g=ne,N=re,$=_e,z=de,se=he,ae=Se,oe=ge;return s(),a("div",null,[n(ae,{name:"default"},{default:f(()=>{var R,A;return[((R=c(p))==null?void 0:R.status)==0?(s(),a("div",je,Me)):((A=c(p))==null?void 0:A.status)==1?(s(),W($,{key:1,class:"bg-white rounded-[6px]"},{default:f(()=>{var K,O;return[e("div",Ne,[$e,e("div",Re,[Ae,n(g,{height:"40px",direction:"vertical",autoplay:!0,class:"w-full"},{default:f(()=>[(s(!0),a(P,null,E(c(j),o=>(s(),W(h,{key:o},{default:f(()=>[e("div",Ke,[n(x,{src:o.avatar,size:28},null,8,["src"]),e("span",Oe,d(o.nickname)+" 开通了 "+d(o.member_package),1)])]),_:2},1024))),128))]),_:1})]),n($,null,{default:f(()=>{var o;return[e("div",Qe,[(s(!0),a(P,null,E((o=c(p))==null?void 0:o.lists,(l,F)=>(s(),a("div",{key:F,class:T(["cursor-pointer box-boder flex-none rounded-[14px] mr-[20px]",{member__active:c(w)==l.id}]),onClick:bt=>L(l,F)},[e("div",Ue,[l.is_perpetual?(s(),a("span",qe,"永久")):(s(),a("span",Je," 有效期"+d(l.duration)+"个月 ",1))]),e("div",Ge,[e("div",He,[n(N,{content:l.sell_price,color:"#101010",mainSize:"30px",minorSize:"30px",fontWeight:"600"},{prefix:f(()=>[Xe]),_:2},1032,["content"]),Ye,e("div",Ze,d(l.name),1)]),l.lineation_price!="0.00"?(s(),a("div",et," 原价￥"+d(l.lineation_price),1)):k("",!0)])],10,Te))),128))])]}),_:1}),e("div",tt,[st,(s(!0),a(P,null,E(c(D).member_benefits,o=>Q((s(),a("div",{key:o.id,class:"ml-[15px] flex justify-between items-center"},[o.is_checked?(s(),a("span",at,[n(z,{name:"el-icon-Select"})])):(s(),a("span",ot,[n(z,{name:"el-icon-CloseBold"})])),e("span",null,d(o.name),1)],512)),[[ke,o.is_checked]])),128))]),c(y).length?(s(),a("div",ct,[nt,e("div",lt,[e("div",it,[(s(!0),a(P,null,E(c(y),(o,l)=>(s(),a("div",{key:l,class:T(["cursor-pointer flex items-center w-[150px] mb-[15px] px-[10px] py-[15px] rounded-lg pay_way_unactive mr-2",{pay_way_actived:c(u)==o.pay_way}]),onClick:F=>H(o.pay_way)},[e("img",{src:o.icon,class:"h-[24px] w-[24px]"},null,8,_t),e("div",dt,d(o.name),1),o.pay_way==c(u)?(s(),a("div",pt,[n(z,{name:"el-icon-SuccessFilled",color:"#23b571",size:18})])):k("",!0)],10,rt))),128))]),c(C)?(s(),a("div",{key:1,class:"ml-[40px] p-[10px] pay_way_actived w-[140px] h-[140px] rounded-[8px] retry",onClick:te},[n(se,{size:"20",color:"inherit"},{default:f(()=>[n(c(ye))]),_:1}),ht])):(s(),a("div",ut,[Q((s(),a("div",mt,[(K=c(I))!=null&&K.config?(s(),W(Ie,{key:0,value:(O=c(I))==null?void 0:O.config,size:120},null,8,["value"])):k("",!0)])),[[oe,c(m)]]),e("div",xt,[e("div",ft,d(c(u)==2?"微信扫码支付":"支付宝扫码支付"),1),e("div",yt,[vt,n(N,{content:c(D).sell_price,color:"#FF2C3C",mainSize:"24px",minorSize:"14px",fontWeight:"600"},null,8,["content"])])])]))])])):k("",!0)])]}),_:1})):k("",!0)]}),_:1})])}}});const Rt=Ve(gt,[["__scopeId","data-v-3282f1eb"]]);export{Rt as default};
